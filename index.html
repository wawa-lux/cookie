<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Play with Cookies</title>

<style>
* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
    user-select: none;
    font-family: Arial, sans-serif;
}

html, body {
    width: 100%;
    height: 100%;
    overflow: hidden;
}

/* ===== PAGES ===== */
.page {
    display: none;
    width: 100vw;
    height: 100vh;
}

/* ===== HOME ===== */
#home {
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    background: yellow;
    text-align: center;
}

#home h1 {
    font-size: 3rem;
    margin-bottom: 20px;
}

.btn {
    padding: 15px 35px;
    font-size: 1.2rem;
    border: none;
    border-radius: 10px;
    margin: 10px;
    cursor: pointer;
}

.play-btn {
    background: blue;
    color: white;
}

.cmd-btn {
    background: black;
    color: white;
}

/* ===== GAME ===== */
#game {
    background: pink;
    position: relative;
    width: 100%;
    height: 100%;
    touch-action: manipulation;
}

/* STACK FIXED */
#stack {
    position: absolute;
    bottom: 0;
    left: 0;
    width: 100%;
    display: flex;
    flex-direction: column-reverse;
    align-items: center;
    pointer-events: none; /* VERY IMPORTANT */
}

.cookie {
    font-size: 40px;
    line-height: 1;
}

.huge { font-size: 70px; }
.mega { font-size: 110px; }

/* MILK */
.milk {
    position: absolute;
    font-size: 120px;
    left: 50%;
    top: 40%;
    transform: translate(-50%, -50%);
}

/* ===== COMMANDS ===== */
#commands {
    background: #f1f1f1;
    padding: 30px;
    overflow-y: auto;
}

#commands h2 {
    margin-bottom: 15px;
}

#commands ul {
    font-size: 1.1rem;
    line-height: 2rem;
}

.back-btn {
    margin-top: 25px;
    background: blue;
    color: white;
}
</style>
</head>

<body>

<!-- HOME -->
<div id="home" class="page" style="display:flex;">
    <h1>Play with cookies now!</h1>
    <button class="btn play-btn" onclick="goGame()">Play now!</button>
    <button class="btn cmd-btn" onclick="goCommands()">Commands</button>
</div>

<!-- GAME -->
<div id="game" class="page">
    <div id="stack"></div>
</div>

<!-- COMMANDS -->
<div id="commands" class="page">
    <h2>PC Commands</h2>
    <ul>
        <li><b>Click</b> â€“ Spawn cookie</li>
        <li><b>Ctrl + Click</b> â€“ Double cookie</li>
        <li><b>Alt + Click</b> â€“ Huge cookie</li>
        <li><b>Alt + Click x3</b> â€“ Mega huge cookie</li>
        <li><b>Space</b> â€“ Cookie</li>
        <li><b>Tab</b> â€“ Milk, reset</li>
    </ul>

    <h2 style="margin-top:20px;">Mobile Commands</h2>
    <ul>
        <li><b>Tap</b> â€“ Spawn cookie</li>
        <li><b>2 Finger Tap</b> â€“ Huge cookie</li>
        <li><b>3 Fast Taps</b> â€“ Mega huge cookie</li>
        <li><b>First Tap</b> â€“ Fullscreen ON</li>
    </ul>

    <button class="btn back-btn" onclick="goHome()">Back</button>
</div>

<script>
const game = document.getElementById("game");
const stack = document.getElementById("stack");

let altClicks = 0;
let tapCount = 0;
let lastTap = 0;
let fullscreenStarted = false;

/* ===== FULLSCREEN FIX (MOBILE SAFE) ===== */
function enterFullscreen() {
    if (!fullscreenStarted) {
        fullscreenStarted = true;
        const el = document.documentElement;
        if (el.requestFullscreen) el.requestFullscreen();
        else if (el.webkitRequestFullscreen) el.webkitRequestFullscreen();
    }
}

/* ===== PAGE NAV ===== */
function showPage(id) {
    document.querySelectorAll(".page").forEach(p => p.style.display = "none");
    document.getElementById(id).style.display = "block";
}

function goGame() {
    showPage("game");
}

function goHome() { showPage("home"); }
function goCommands() { showPage("commands"); }

/* ===== SPAWN COOKIE (NO LIMIT) ===== */
function spawnCookie(size = "normal", double = false) {
    const c = document.createElement("div");
    c.className = "cookie";
    c.innerHTML = double ? "ðŸªðŸª" : "ðŸª";

    if (size === "huge") c.classList.add("huge");
    if (size === "mega") c.classList.add("mega");

    stack.appendChild(c);

    /* HARD FIX: if stack is too big, scroll it internally */
    if (stack.children.length > 300) {
        stack.removeChild(stack.lastChild);
    }
}

/* ===== MOUSE ===== */
game.addEventListener("click", e => {
    let size = "normal";
    let double = false;

    if (e.ctrlKey) double = true;

    if (e.altKey) {
        altClicks++;
        size = altClicks >= 3 ? "mega" : "huge";
        if (altClicks >= 3) altClicks = 0;
    }

    spawnCookie(size, double);
});

/* ===== MOBILE ===== */
game.addEventListener("touchstart", e => {
    enterFullscreen();

    let now = Date.now();
    tapCount = (now - lastTap < 300) ? tapCount + 1 : 1;
    lastTap = now;

    if (e.touches.length === 2) {
        spawnCookie("huge");
    } else if (tapCount >= 3) {
        spawnCookie("mega");
        tapCount = 0;
    } else {
        spawnCookie();
    }
});

/* ===== KEYBOARD ===== */
document.addEventListener("keydown", e => {
    if (e.code === "Space") {
        spawnCookie();
    }

    if (e.code === "Tab") {
        e.preventDefault();
        const milk = document.createElement("div");
        milk.className = "milk";
        milk.innerHTML = "ðŸ¥›";
        game.appendChild(milk);

        setTimeout(() => {
            stack.innerHTML = "";
            milk.remove();
        }, 1200);
    }
});
</script>

</body>
</html>

